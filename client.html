<!DOCTYPE html>
<html lang="el" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Συνολική Μέτρηση — Ποιότητα Ζωής & Αέρα</title>
  <style>
    :root{
      --bg: linear-gradient(180deg,#0b1224,#0f1b38);
      --card: rgba(16,23,42,.78);
      --text:#e6ecff; --muted:#9aa6b2; --border:#223155;
      --good:#34d399; --mid:#fbbf24; --bad:#f87171;
      --primary:#3b82f6; --shadow:0 12px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text); background:var(--bg);
      overflow-x:hidden;
    }

    /* === Windy-like animated background (put your GIF path below) === */
    .bg-windy{
      position:fixed; inset:0; z-index:0; pointer-events:none;
      background: url("gif_background.gif") center / cover no-repeat fixed; /* ← ΑΛΛΑΞΕ ΤΟ ΜΟΝΟ ΑΥΤΟ */
      filter: blur(1px) brightness(.9) saturate(1.05);
      opacity:.35;
    }
    /* soft vignette to κρατάει αναγνωσιμότητα */
    .bg-windy::after{
      content:""; position:absolute; inset:0; pointer-events:none;
      background: radial-gradient(1200px 600px at 30% -10%, transparent 0%, rgba(0,0,0,.25) 70%),
                  linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.1) 30%, rgba(0,0,0,.25));
      mix-blend-mode:multiply;
    }

    .wrap{position:relative; z-index:1; max-width:980px; margin:0 auto; padding:20px}
    .top{display:flex;align-items:center;gap:12px}
    .logo{display:flex;align-items:center;gap:8px}
    .dot{width:12px;height:12px;border-radius:50%;background:var(--primary);box-shadow:0 0 0 6px rgba(59,130,246,.12)}
    h1{margin:0;font-size:1.5rem}
    .muted{color:var(--muted);font-size:14px}

    .card{background:var(--card);backdrop-filter:blur(8px);border:1px solid var(--border);border-radius:18px;padding:16px;box-shadow:var(--shadow)}
    .row{display:flex;gap:14px;flex-wrap:wrap}
    .controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    select,.btn{border:1px solid var(--border);background:transparent;border-radius:12px;padding:10px 12px;font-size:14px;color:var(--text)}
    .btn.primary{background:var(--primary);color:#fff;border-color:transparent}

    .switch{display:inline-flex;align-items:center;gap:8px;cursor:pointer}
    .switch input{display:none}
    .switch .track{width:44px;height:26px;border-radius:999px;background:#1f2b46;position:relative}
    .switch .thumb{position:absolute;top:3px;left:3px;width:20px;height:20px;border-radius:50%;background:var(--primary);transition:left .2s}
    .switch input:checked + .track .thumb{left:21px}

    /* --- Meter (donut) --- */
    .meter{position:relative;width:220px;height:220px}
    .meter svg{transform:rotate(-90deg)}
    .num{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
    .num .big{font-size:46px;font-weight:800;line-height:1}
    .num .label{font-size:12px;color:var(--muted)}
    .emoji{font-size:34px;margin-top:6px;animation:floaty 3s ease-in-out infinite}

    /* --- Good/Bad bar --- */
    .bar{position:relative;height:14px;border-radius:999px;background:#1f2937;overflow:hidden;border:1px solid var(--border)}
    .bar .good{height:100%;background:var(--good);width:0}
    .bar .bad{height:100%;background:var(--bad);width:0;position:absolute;right:0}
    .split-row{display:flex;justify-content:space-between;margin-top:6px;font-size:13px}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:rgba(16,23,42,.6)}
    .pill .dot{width:10px;height:10px;border-radius:50%}
    .pill.good .dot{background:var(--good)} .pill.bad .dot{background:var(--bad)}

    /* --- Icon grid --- */
    .icons{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:12px}
    .ico{display:flex;gap:10px;align-items:center;border:1px solid var(--border);border-radius:14px;padding:10px;background:rgba(16,23,42,.6)}
    .ico svg{width:24px;height:24px}

    @keyframes floaty{0%{transform:translateY(0)}50%{transform:translateY(-4px)}100%{transform:translateY(0)}}
  </style>
</head>
<body>

  <!-- Animated Windy-like background (GIF) -->
  <div class="bg-windy"></div>

  <div class="wrap">
    <div class="top">
      <div class="logo"><div class="dot"></div><h1>Συνολική Μέτρηση</h1></div>
      <div style="flex:1"></div>
      <label class="switch" title="Dark (visual only)">
        <input id="theme" type="checkbox"><div class="track"><div class="thumb"></div></div>
        <span class="muted">Dark</span>
      </label>
    </div>
    <div class="muted" style="margin-top:6px">Μία τιμή που συνοψίζει ποιότητα ζωής και ποιότητα αέρα. Διάλεξε χώρα και δες το αποτέλεσμα.</div>

    <div class="card" style="margin-top:12px">
      <div class="controls">
        <select id="country">
          <option>Greece</option><option>Italy</option><option>Spain</option><option>Portugal</option>
          <option>France</option><option>Germany</option><option>Netherlands</option><option>United Kingdom</option>
          <option>Sweden</option><option>Norway</option><option>Finland</option><option>Denmark</option>
          <option>Poland</option><option>Czechia</option><option>Austria</option><option>Switzerland</option>
          <option>United States</option><option>Canada</option><option>Japan</option><option>Australia</option>
        </select>
        <button id="run" class="btn primary">Υπολόγισε</button>
      </div>
    </div>

    <div class="row" style="margin-top:12px">
      <!-- Donut -->
      <div class="card" style="flex:1 1 360px;display:flex;gap:18px;align-items:center;justify-content:center">
        <div class="meter">
          <svg width="220" height="220">
            <circle cx="110" cy="110" r="92" stroke="#25324c" stroke-width="18" fill="none"/>
            <circle id="arc" cx="110" cy="110" r="92" stroke="var(--good)" stroke-width="18" stroke-linecap="round" fill="none" stroke-dasharray="578" stroke-dashoffset="578"/>
          </svg>
          <div class="num">
            <div id="score" class="big">—</div>
            <div class="label">Συνολική Βαθμολογία</div>
            <div id="face" class="emoji">🙂</div>
          </div>
        </div>
      </div>

      <!-- Split bar + icons -->
      <div class="card" style="flex:1 1 420px">
        <div class="muted">Κατανομή</div>
        <div class="bar" style="margin-top:6px">
          <div id="goodBar" class="good"></div>
          <div id="badBar" class="bad"></div>
        </div>
        <div class="split-row">
          <div class="pill good"><div class="dot"></div><span>Καλό</span> <b id="goodPct">—</b></div>
          <div class="pill bad"><div class="dot"></div><span>Όχι τόσο καλό</span> <b id="badPct">—</b></div>
        </div>

        <div class="icons">
          <div class="ico">
            <svg viewBox="0 0 24 24" fill="none" stroke="var(--good)" stroke-width="2"><path d="M5 21c8 0 14-6 14-14V3h-4C7 3 3 7 3 13v8h2z"/><path d="M9 15l6-6"/></svg>
            <div><div class="muted">Αέρας</div><b id="ico_air">—</b></div>
          </div>
          <div class="ico">
            <svg viewBox="0 0 24 24" fill="none" stroke="var(--primary)" stroke-width="2"><path d="M3 9.5L12 3l9 6.5V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V9.5z"/></svg>
            <div><div class="muted">Ζωή</div><b id="ico_qol">—</b></div>
          </div>
          <div class="ico">
            <svg viewBox="0 0 24 24" fill="none" stroke="var(--mid)" stroke-width="2"><path d="M8 21h8"/><path d="M12 17v4"/><path d="M4 4h16v3a5 5 0 0 1-5 5H9A5 5 0 0 1 4 7V4z"/><path d="M4 7H2a3 3 0 0 0 3 3"/><path d="M20 7h2a3 3 0 0 1-3 3"/></svg>
            <div><div class="muted">Θέση</div><b id="ico_rank">—</b></div>
          </div>
          <div class="ico">
            <svg viewBox="0 0 24 24" fill="none" stroke="var(--text)" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 8h.01"/><path d="M11 12h2v4h-2z"/></svg>
            <div><div class="muted">Σήμανση</div><b id="ico_flag">—</b></div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/* ---------- Δεδομένα (mock) ---------- */
var DB=[
 {country:'Greece',qol:74,aqi:88},{country:'Italy',qol:76,aqi:95},{country:'Spain',qol:78,aqi:70},
 {country:'Portugal',qol:79,aqi:60},{country:'France',qol:82,aqi:65},{country:'Germany',qol:83,aqi:58},
 {country:'Netherlands',qol:85,aqi:62},{country:'United Kingdom',qol:84,aqi:63},{country:'Sweden',qol:86,aqi:45},
 {country:'Norway',qol:87,aqi:42},{country:'Finland',qol:87,aqi:40},{country:'Denmark',qol:86,aqi:48},
 {country:'Poland',qol:71,aqi:120},{country:'Czechia',qol:75,aqi:95},{country:'Austria',qol:85,aqi:55},
 {country:'Switzerland',qol:88,aqi:38},{country:'United States',qol:86,aqi:68},{country:'Canada',qol:86,aqi:50},
 {country:'Japan',qol:85,aqi:63},{country:'Australia',qol:85,aqi:52}
];

/* ---------- Υπολογισμός μίας τιμής ---------- */
var W=0.4;
function score(qol, aqi){
  var penalty=Math.max(0,Math.min(1,(aqi||0)/300));
  return Math.round((1 - W*penalty) * (qol||0));
}
function get(name){ for(var i=0;i<DB.length;i++) if(DB[i].country===name) return DB[i]; return null; }
function rank(name){
  var arr=DB.map(function(c){return{name:c.country,s:score(c.qol,c.aqi)};}).sort(function(a,b){return b.s-a.s;});
  for(var i=0;i<arr.length;i++) if(arr[i].name===name) return {rank:i+1, of:arr.length};
  return {rank:null,of:arr.length};
}
function flagFromAQI(aqi){ return aqi<=50?'Καλός':'Όχι καλός'; }
function faceFromScore(s){ if(s>=80) return '😄'; if(s>=60) return '🙂'; if(s>=40) return '😐'; return '😕'; }
function getVar(n){ return getComputedStyle(document.documentElement).getPropertyValue(n).trim(); }
function colorForScore(s){ return s>=80 ? getVar('--good') : (s>=60 ? '#fbbf24' : getVar('--bad')); }

/* ---------- Theme (visual toggle) ---------- */
var theme=document.getElementById('theme');
function setTheme(mode){ document.documentElement.setAttribute('data-theme',mode); theme.checked=(mode==='dark'); }
setTheme('light'); theme.addEventListener('change', ()=> setTheme(theme.checked?'light':'light')); // κρατάμε τη dark παλέτα ήδη

/* ---------- Animations ---------- */
function animateNumber(el,to,ms){ var start=0,t0=null; function step(ts){ if(!t0)t0=ts; var p=Math.min(1,(ts-t0)/ms); el.textContent=Math.round(start+(to-start)*p); if(p<1) requestAnimationFrame(step);} requestAnimationFrame(step); }
function animateWidth(el,toPct,ms){ el.style.transition='width '+ms+'ms ease-in-out'; el.style.width=toPct+'%'; }
function animateDonut(toPct){ var arc=document.getElementById('arc'); var total=578; var offset=total*(1-toPct/100); arc.style.transition='stroke-dashoffset 900ms ease-in-out, stroke 300ms'; arc.style.strokeDashoffset=String(offset); }

/* ---------- Main ---------- */
var sel=document.getElementById('country'); var run=document.getElementById('run');
run.addEventListener('click', function(){
  var c=get(sel.value); if(!c){ alert('Δεν βρέθηκε χώρα'); return; }
  var s=score(c.qol,c.aqi); var good=s, bad=100-s;

  animateNumber(document.getElementById('score'), s, 900);
  document.getElementById('face').textContent = faceFromScore(s);

  var arc=document.getElementById('arc'); arc.setAttribute('stroke', colorForScore(s)); animateDonut(s);

  animateWidth(document.getElementById('goodBar'), good, 800);
  animateWidth(document.getElementById('badBar'), bad, 800);
  animateNumber(document.getElementById('goodPct'), good, 900);
  animateNumber(document.getElementById('badPct'), bad, 900);

  document.getElementById('ico_air').textContent = 'AQI '+c.aqi+' · '+flagFromAQI(c.aqi);
  document.getElementById('ico_qol').textContent = c.qol+'%';
  var r=rank(c.country); document.getElementById('ico_rank').textContent = r.rank+'/'+r.of;
  document.getElementById('ico_flag').textContent = s>=60 ? 'Καλό συνολικά' : 'Θέλει βελτίωση';
});
run.click();
</script>
</body>
</html>
